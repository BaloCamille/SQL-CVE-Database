#create and populate all the tables

#create CVE table
DROP TABLE IF EXISTS CVE;
CREATE TABLE CVE (
	CVE_ID CHAR(15) PRIMARY KEY NOT NULL,
    DISCOVERY_DATE DATE,
    PATCH_AVAIL BOOLEAN,
    VULN_TYPE CHAR(25) NOT NULL,
    CVSS_SCORE DECIMAL (3,1),
    CVE_NAME CHAR(255)
);

#populate the CVE table
INSERT INTO CVE VALUES('CVE-2021-21017', '2021-02-11', TRUE, 'Buffer Overflow', 8.8, 'Adobe Acrobat and Reader Heap-based Buffer Overflow Vulnerability.');
INSERT INTO CVE VALUES('CVE-2023-28206', '2023-04-10', TRUE, 'Remote Code Execution', 9.8, 'Apple iOS, iPadOS, and macOS IOSurfaceAccelerator Out-of-Bounds Write Vulnerability.');
INSERT INTO CVE VALUES('CVE-2023-23397', '2023-03-14', TRUE, 'Privilege Escalation', 9.8, 'Microsoft Office Outlook Privilege Escalation Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-42475', '2023-01-02', TRUE, 'Buffer Overflow', 9.8, 'Fortinet FortiOS Heap-Based Buffer Overflow Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-4135', '2022-11-24', TRUE, 'Buffer Overflow', 9.6, 'Google Chromium Heap Buffer Overflow Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-41328', '2023-03-07', TRUE, 'Privilege Escalation', 7.1, 'Fortinet FortiOS Path Traversal Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-40684', '2022-10-18', TRUE, 'Authentication Bypass', 9.8, 'Fortinet Multiple Products Authentication Bypass Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-32917', '2022-09-20', TRUE, 'Remote Code Execution', 7.8, 'Apple iOS, iPadOS, and macOS Remote Code Execution Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-27518', '2022-12-13', TRUE, 'Authentication Bypass', 9.8, 'Citrix Application Delivery Controller (ADC) and Gateway Authentication Bypass Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-0847', '2022-03-10', TRUE, 'Privilege Escalation', 7.8, 'Linux Kernel Privilege Escalation Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-0028', '2022-08-10', TRUE, 'DoS', 8.6, 'Palo Alto Networks PAN-OS Reflected Amplification Denial-of-Service Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-38003', '2021-11-23', TRUE, 'Misconfiguration', 8.8, 'Google Chromium V8 Engine Memory Corruption Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-37976', '2021-08-10', TRUE, 'Information Disclosure', 6.5, 'Google Chrome Information Leakage.');
INSERT INTO CVE VALUES('CVE-2021-30983', '2021-08-24', TRUE, 'Buffer Overflow', 7.8, 'Apple iOS and iPadOS Buffer Overflow Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-30665', '2021-09-08', TRUE, 'Buffer Overflow', 8.8, 'Apple Safari Webkit Browser Engine Buffer Overflow Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-30563', '2021-08-03', TRUE, 'Remote Code Execution', 8.8, 'Google Chrome Browser V8 Arbitrary Code Execution.');
INSERT INTO CVE VALUES('CVE-2021-21985', '2021-05-26', TRUE, 'Remote Code Execution', 9.8, 'VMware vCenter Server Remote Code Execution Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-21973', '2021-02-24', TRUE, 'CSRF/SSRF', 5.3, 'VMware vCenter Server and Cloud Foundation Server Side Request Forgery (SSRF) Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-21224', '2021-04-26', TRUE, 'Remote Code Execution', 8.8, 'Chromium V8 JavaScript Engine Remote Code Execution Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-21148', '2021-02-09', TRUE, 'Buffer Overflow', 8.8, 'Chromium V8 JavaScript Rendering Engine Heap Buffer Overflow Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-1879', '2021-04-02', TRUE, 'XSS', 6.1, 'Apple iOS Webkit Browser Engine XSS.');
INSERT INTO CVE VALUES('CVE-2021-1498', '2021-05-06', TRUE, 'Injection', 9.8, 'Cisco HyperFlex HX Command Injection Vulnerabilities.');
INSERT INTO CVE VALUES('CVE-2020-8196', '2020-07-10', TRUE, 'Authentication Bypass', 4.3, 'Citrix ADC, Citrix Gateway, Citrix SDWAN WANOP Unauthenticated Authorization Bypass.');
INSERT INTO CVE VALUES('CVE-2020-4427', '2020-05-07', TRUE, 'Authentication Bypass', 9.8, 'IBM Data Risk Manager Authentication Bypass.');
INSERT INTO CVE VALUES('CVE-2020-4006', '2020-11-23', TRUE, 'Injection', 9.1, 'VMware Workspace One Access, Access Connector, Identity Manager, and Identity Manager Connector Command Injection Vulnerability.');
INSERT INTO CVE VALUES('CVE-2020-3952', '2020-04-10', TRUE, 'Information Disclosure', 9.8, 'VMware vCenter Server Info Disclosure Vulnerability.');
INSERT INTO CVE VALUES('CVE-2020-3580', '2020-10-21', FALSE, 'XSS', 6.1, 'Cisco ASA and FTD XSS Vulnerabilities.');
INSERT INTO CVE VALUES('CVE-2020-3161', '2020-04-15', TRUE, 'Remote Code Execution', 9.8, 'Cisco IP Phones Web Server DoS and Remote Code Execution Vulnerability.');
INSERT INTO CVE VALUES('CVE-2020-2021', '2020-06-29', TRUE, 'Authentication Bypass', 10.0, 'Palo Alto Networks PAN-OS Authentication Bypass Vulnerability.');
INSERT INTO CVE VALUES('CVE-2020-17530', '2020-12-10', TRUE, 'Remote Code Execution', 9.8, 'Apache Struts Forced OGNL Double Evaluation Remote Code Execution.');
INSERT INTO CVE VALUES('CVE-2020-10148', '2020-12-29', TRUE, 'Authentication Bypass', 9.8, 'SolarWinds Orion API Authentication Bypass Vulnerability.');
INSERT INTO CVE VALUES('CVE-2020-0041', '2020-03-10', TRUE, 'Privilege Escalation', 7.8, 'Android Kernel Out-of-Bounds Write Vulnerability.');
INSERT INTO CVE VALUES('CVE-2019-9978', '2019-03-24', TRUE, 'XSS', 6.1, 'WordPress Social-Warfare plugin XSS.');
INSERT INTO CVE VALUES('CVE-2019-5591', '2020-08-14', TRUE, 'Misconfiguration', 6.5, 'Fortinet FortiOS Default Configuration Vulnerability.');
INSERT INTO CVE VALUES('CVE-2019-3010', '2019-10-16', TRUE, 'Privilege Escalation', 8.8, 'Oracle Solaris Privilege Escalation Vulnerability.');
INSERT INTO CVE VALUES('CVE-2019-2725', '2019-04-26', TRUE, 'Injection', 9.8, 'Oracle WebLogic Server, Injection.');
INSERT INTO CVE VALUES('CVE-2019-15752', '2019-08-28', TRUE, 'Privilege Escalation', 7.8, 'Docker Desktop Community Edition Privilege Escalation Vulnerability.');
INSERT INTO CVE VALUES('CVE-2018-6065', '2018-11-24', TRUE, 'Buffer Overflow', 8.8, 'Google Chromium V8 Integer Overflow Vulnerability.');
INSERT INTO CVE VALUES('CVE-2018-0180', '2018-03-28', FALSE, 'DoS', 5.9, 'Cisco IOS Software Denial-of-Service Vulnerability.');
INSERT INTO CVE VALUES('CVE-2013-1690', '2013-06-05', TRUE, 'DoS', 9.3, 'Mozilla Firefox and Thunderbird Denial-of-Service Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-41128', '2022-11-09', TRUE, 'Remote Code Execution', 8.8, 'Microsoft Windows Scripting Languages Remote Code Execution Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-26904', '2022-04-15', TRUE, 'Privilege Escalation', 7.0, 'Microsoft Windows User Profile Service Privilege Escalation Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-38649', '2021-09-15', TRUE, 'Privilege Escalation', 7.8, 'Microsoft Azure Open Management Infrastructure (OMI) Privilege Escalation Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-38647', '2021-09-15', TRUE, 'Remote Code Execution', 9.8, 'Microsoft Azure Open Management Infrastructure (OMI) Remote Code Execution Vulnerability.');
INSERT INTO CVE VALUES('CVE-2022-44698', '2022-12-13', TRUE, 'Authentication Bypass', 5.4, 'Microsoft Defender SmartScreen Security Feature Bypass Vulnerability.');
INSERT INTO CVE VALUES('CVE-2016-3351', '2016-09-14', TRUE, 'Information Disclosure', 3.1, 'Microsoft Internet Explorer and Edge Information Disclosure Vulnerability.');
INSERT INTO CVE VALUES('CVE-2020-9819', '2020-06-09', TRUE, 'Buffer Overflow', 4.3, 'Apple iOS Mail Heap Overflow Vulnerability.');
INSERT INTO CVE VALUES('CVE-2019-1388', '2019-11-12', TRUE, 'Privilege Escalation', 7.8, 'Microsoft Windows Certificate Dialog Privilege Escalation Vulnerability.');
INSERT INTO CVE VALUES('CVE-2023-24880', '2023-03-14', TRUE, 'Authentication Bypass', 4.4, 'Microsoft Windows SmartScreen Security Feature Bypass Vulnerability.');
INSERT INTO CVE VALUES('CVE-2021-34484', '2021-08-12', TRUE, 'Privilege Escalation', 7.8, 'Microsoft Windows User Profile Service Privilege Escalation Vulnerability.');
INSERT INTO CVE VALUES('CVE-2015-2426', '2015-07-15', TRUE, 'Remote Code Execution', 9.3, 'Microsoft Windows Adobe Type Manager Library Remote Code Execution Vulnerability.');
INSERT INTO CVE VALUES('CVE-2020-0601', '2020-01-14', TRUE, 'Cryptographic', 8.1, 'Microsoft Windows 10 API/ECC Vulnerability.');


#create the product table
DROP TABLE IF EXISTS PRODUCT;
CREATE TABLE PRODUCT (
    PRODUCT_NAME CHAR(40) PRIMARY KEY NOT NULL,
    VENDOR_NAME CHAR(40) NOT NULL,
    RELEASE_YEAR CHAR(4),
    PRODUCT_SUPPORT BOOLEAN,
    PRODUCT_EOL_YEAR CHAR(4),
    PRODUCT_DESCRIPTION CHAR(255)
);

#populate the PRODUCT table
INSERT INTO PRODUCT VALUES ('Acrobat', 'Adobe', '1993', TRUE, 'N/A', 'A popular PDF reader and editor.');
INSERT INTO PRODUCT VALUES ('Reader', 'Adobe', '1993', TRUE, 'N/A', 'A free PDF reader.');
INSERT INTO PRODUCT VALUES ('Android OS', 'Android', '2008', TRUE, 'TBD', 'A mobile OS.');
INSERT INTO PRODUCT VALUES ('Struts', 'Apache', '2000', FALSE, '2018', 'An open-source web application framework for Java');
INSERT INTO PRODUCT VALUES ('Apple iOS', 'Apple', '2007', TRUE, 'TBD', 'A mobile OS.');
INSERT INTO PRODUCT VALUES ('macOS', 'Apple', '2001', TRUE, 'TBD', 'An OS for Macintosh computers.');
INSERT INTO PRODUCT VALUES ('iOS Mail', 'Apple', '2007', TRUE, 'TBD', 'iOS native email client.');
INSERT INTO PRODUCT VALUES ('Safari', 'Apple', '2003', TRUE, 'TBD', 'macOS and iOS web browser.');
INSERT INTO PRODUCT VALUES ('ASA', 'Cisco', '2005', FALSE, '2018', 'Security-focused network device');
INSERT INTO PRODUCT VALUES ('HyperFlex HX', 'Cisco', '2016', TRUE, 'TBD', 'A hyperconverged infrastructure solution.');
INSERT INTO PRODUCT VALUES ('Cisco IOS', 'Cisco', '1987', FALSE, '2017', 'A family of network operating systems used on Cisco networking equipment.');
INSERT INTO PRODUCT VALUES ('IP Phones', 'Cisco', '1997', FALSE, '2020', 'A family of VoIP phones');
INSERT INTO PRODUCT VALUES ('ADC', 'Citrix', '1997', TRUE, 'TBD', 'A software and hardware application delivery controller.');
INSERT INTO PRODUCT VALUES ('Gateway', 'Citrix', '2005', TRUE, 'TBD', 'A secure remote access solution.');
INSERT INTO PRODUCT VALUES ('Workspace', 'Citrix', '2018', TRUE, 'TBD', 'A digital workspace platform.');
INSERT INTO PRODUCT VALUES ('Desktop CE', 'Docker', '2013', TRUE, 'TBD', 'A software platform that allowes developers to build, test, and deploy applications in containers.');
INSERT INTO PRODUCT VALUES ('FortiOS', 'Fortinet', '2004', TRUE, 'TBD', 'A security-based OS for network security appliances.');
INSERT INTO PRODUCT VALUES ('Chrome', 'Google', '2008', TRUE, 'TBD', 'A web browser.');
INSERT INTO PRODUCT VALUES ('Chromium V8 Engine', 'Google', '2008', TRUE, 'TBD', 'The open-source JavaScript engine used in Google Chrome adn other Chromium-based web browsers.');
INSERT INTO PRODUCT VALUES ('Data Risk Manager', 'IBM', '2019', TRUE, 'TBD', 'A security and compliance solution.');
INSERT INTO PRODUCT VALUES ('Windows', 'Microsoft', '1985', TRUE, 'TBD', 'A family of OSs.');
INSERT INTO PRODUCT VALUES ('Azure OMI', 'Microsoft', '2015', TRUE, 'TBD', 'A management protocol for managing and monitoring Windows adn Linux OSs.');
INSERT INTO PRODUCT VALUES ('Edge', 'Microsoft', '2015', TRUE, 'TBD', 'A web browser.');
INSERT INTO PRODUCT VALUES ('Defender', 'Microsoft', '2006', TRUE, 'TBD', 'A security software suite.');
INSERT INTO PRODUCT VALUES ('Office', 'Microsoft', '1989', TRUE, 'TBD', 'A suite of productivity software.');
INSERT INTO PRODUCT VALUES ('Outlook', 'Microsoft', '1997', TRUE, '2023', 'Email and personal information manager.');
INSERT INTO PRODUCT VALUES ('JGS516PE', 'Netgear', '2014', FALSE, 'N/A', 'Unmanaged Plus Switch with 16 Gb Ethernet ports and PoE support.');
INSERT INTO PRODUCT VALUES ('Solaris', 'Oracle', '2011', TRUE, 'TBD', 'Unix OS designed for enterprise computing.');
INSERT INTO PRODUCT VALUES ('WebLogic Server', 'Oracle', '2000', TRUE, 'TBD', 'Java EE application server for building and deploying enterprise applications.');
INSERT INTO PRODUCT VALUES ('Virtualization Manager', 'SolarWinds', '2013', TRUE, 'N/A', 'Virtualization and storage management software.');
INSERT INTO PRODUCT VALUES ('Orion Platform', 'SolarWinds', '2002', TRUE, 'N/A', 'Network monitoring and management platform.');
INSERT INTO PRODUCT VALUES ('vCenterServer', 'VMware', '200', TRUE, 'TBD', 'Centralized management platform for VMware vSphere virtualized environments.');
INSERT INTO PRODUCT VALUES ('Social-Warfare', 'WordPress', '2015', FALSE, 'N/A', 'Social sharing plugin.');
INSERT INTO PRODUCT VALUES ('Kernel', 'Linux', '1991', TRUE, 'TBD', 'Core component of the Linux OS.');
INSERT INTO PRODUCT VALUES ('PANOS', 'Palo Alto', '2007', TRUE, 'TBD', 'OS for Palo Alto next-generation firewalls.');
INSERT INTO PRODUCT VALUES ('Firefox', 'Mozilla', '2002', TRUE, 'TBD', 'Open-source web browser.');
INSERT INTO PRODUCT VALUES ('Java SE', 'Oracle', '1998', TRUE, 'TBD', 'Platform for developing and deploying Java applications.');
INSERT INTO PRODUCT VALUES ('Thunderbird', 'Mozilla', '2004', TRUE, 'N/A', 'Free and open-source email client.');
INSERT INTO PRODUCT VALUES ('Internet Explorer', 'Microsoft', '1995', FALSE, '2022', 'Legacy web browser.');
INSERT INTO PRODUCT VALUES ('FTD', 'Cisco', '2016', TRUE, 'N/A', 'Next-generation firewall with unified management.');
INSERT INTO PRODUCT VALUES ('Workspace One Access', 'VMware', '2019', TRUE, 'N/A', 'Identity and access management solution for enterprise applications.');
INSERT INTO PRODUCT VALUES ('Identity Manager', 'VMware', '2016', TRUE, 'N/A', 'Cloud-based identity and access management solution for the enterprise.');
INSERT INTO PRODUCT VALUES ('Access Connector', 'VMware', '2019', TRUE, 'N/A', 'Enables secure remote access to enterprise applications, desktops, and data from anwhere, at anytime.');



#create the VULNERABILITY table
DROP TABLE IF EXISTS VULNERABILITY;
CREATE TABLE VULNERABILITY (
	VULN_TYPE CHAR(25) PRIMARY KEY NOT NULL,
    OWASP_10 BOOLEAN,
    OWASP_2021_RANK INT(2),
    CWE_CODE INT(3),
    CWE_NAME CHAR(80),
    VULN_DESCRIPTION CHAR(255)
);

#populate the VULNERABILITY table
INSERT INTO VULNERABILITY VALUES('Authentication Bypass', TRUE, 7, 290, 'Authentication Bypass by Spoofing', 'Allows an attacker to bypass authentication mechanisms, gain unauthorized access, and potentially perform malicious actions.');
INSERT INTO VULNERABILITY VALUES('Privilege Escalation', FALSE, NULL, 269, 'Improper Privilege Management', 'Allows an attacker to escalate their privileges within a system or gain access to resources they should not have access to.');
INSERT INTO VULNERABILITY VALUES('Injection', TRUE, 3, 94, 'Improper Control of Generation of Code', 'Allows an attacker to inject malicious code into a system, potentially causing it to execute unintended commands or reveal sensitive information.');
INSERT INTO VULNERABILITY VALUES('XSS', FALSE, NULL, 79, 'Improper Neutralization of Input During Web Page Generation', 'Allows an attacker to inject malicious code into a website or web application, potentially allowing them to steal sensitive information or take control of the site.');
INSERT INTO VULNERABILITY VALUES('CSRF/SSRF', TRUE, 10, 918, 'Server Side Request Forgery', 'Allows an attacker to perform actions on behalf of an authenticated user, potentially leading to unauthorized actions being taken or sensitive information being exposed.');
INSERT INTO VULNERABILITY VALUES('Buffer Overflow', FALSE, NULL, 120, 'Buffer Copy Without Checking Size of Input', 'Occurs when a program tries to store more data in a buffer than it was designed to handle, potentially allowing an attacker to execute arbitrary code.');
INSERT INTO VULNERABILITY VALUES('DoS', FALSE, NULL, NULL, NULL, 'Occurs when an attacker floods a system with requests, causing it to crash or become unresponsive.');
INSERT INTO VULNERABILITY VALUES('Misconfiguration', TRUE, 5, NULL, NULL, 'Occurs when a system is configured improperly, potentially allowing an attacker to gain access to sensitive information or perform malicious actions.');
INSERT INTO VULNERABILITY VALUES('Cryptographic', TRUE, 2, 347, 'Improper Verification of Cryptographic Signature', "Occurs when a system's cryptographic algorithms or implementations are flawed, potentially allowing an attacker to bypass encryption or access sensitive data.");
INSERT INTO VULNERABILITY VALUES('Remote Code Execution', FALSE, NULL, NULL, NULL, 'Allows an attacker to execute arbitrary code on a target system from a remote location to take control of the system, steal data, or carry out other malicious activities.');
INSERT INTO VULNERABILITY VALUES('Information Disclosure', FALSE, NULL, 200, 'Exposure of Sensitive Information to an Unauthorized Actor', 'Allows an attacker to access sensitive information on a target system from a remote location to steal data, gain access to other systems, or carry out further attacks.');


#create the VENDOR table
DROP TABLE IF EXISTS VENDOR;
CREATE TABLE VENDOR (
    VENDOR_NAME CHAR(40) PRIMARY KEY NOT NULL,
    PRODUCT_COUNT INT(3),
    BUG_BOUNTY_PROGRAM BOOLEAN,
    VENDOR_CONTACT CHAR(255),
    VENDOR_WEBSITE CHAR(255),
    VENDOR_DESCRIPTION CHAR(255)
);

#populate the VENDOR table
INSERT INTO VENDOR (VENDOR_NAME, BUG_BOUNTY_PROGRAM, VENDOR_CONTACT, VENDOR_WEBSITE, VENDOR_DESCRIPTION) 
VALUES('Adobe', TRUE, '800-915-9428', 'www.adobe.com', 'American multinational computer software company that provides a range of creative and digital marketing software products and services, including Photoshop, Acrobat, and Marketing Cloud.'),
('Apple', TRUE, '800-275-2273', 'www.apple.com', 'American multinational technology company that designs and produces consumer electronics, software, and online services.'),
('Microsoft', TRUE, '877-696-7786', 'www.microsoft.com', 'American multinational technology company that develops, licenses, and sells computer software, consumer electronics, and personal computers.'),
('Google', TRUE, '866-246-6453', 'www.google.com', 'American multinational technology company that specializes in internet-related services and products, including search engines, online advertising technologies, cloud computing, and software.'),
('Android', TRUE, '', 'www.android.com', 'Mobile operating system developed by Google.'),
('Oracle', TRUE, '800-223-1711', 'www.oracle.com', 'American multinational computer technology corporation that specializes in developing and marketing database software and technology, cloud engineered systems, and enterprise software products.'),
('Apache', TRUE, '', 'www.apache.org', 'Open-source software foundation that develops and supports a diverse range of software projects, including web servers, data storage, and data processing frameworks.'),
('Cisco', TRUE, '800-187-3652', 'www.cisco.com', 'American multinational technology conglomerate that develops, manufactures, and sells networking hardware, telecommunications equipment, and other high-technology services and products.'),
('Citrix', TRUE, '800-441-3453', 'www.citrix.com', 'American multinational software company that provides server, application and desktop virtualization, networking, software as a service (SaaS), and cloud computing technologies.'),
('Docker', TRUE, '', 'www.docker.com', 'Platform for developers and system administrators to develop, deploy, and run applications with containers.'),
('Fortinet', TRUE, '408-542-7780', 'www.fortinet.com', 'American multinational corporation that provides cybersecurity software and services, including firewalls, antivirus software, intrusion prevention systems, and endpoint security.'),
('Mozilla', TRUE, '', 'www.mozilla.org', 'American non-profit organization that produces open-source software, including the Firefox web browser and Thunderbird email client.'),
('Netgear', TRUE, '800-419-4543', 'www.netgear.com', 'American global networking company that provides networking hardware for consumers, businesses, and service providers.'),
('SolarWinds', TRUE, '866-530-8040', 'www.solarwinds.com', 'American company that develops software for managing networks, systems, and information technology infrastructure.'),
('VMware', TRUE, '877-486-9273', 'www.vmware.com', 'American software company that provides cloud computing and virtualization software and services.'),
('WordPress', TRUE, '877-273-3049', 'www.wordpress.org', 'Open-source content management system used to create and manage websites and blogs.'),
('IBM', TRUE, '800-426-4968', 'www.ibm.com', 'American multinational technology company that provides hardware, software, cloud-based services, and cognitive computing solutions.'),
('Intel', TRUE, '877-811-2574', 'www.intel.com', 'American multinational technology company that develops and manufactures computer processors and other hardware components.'),
('Palo Alto', TRUE, '866-320-4788', 'www.paloaltonetworks.com', 'American multinational cybersecurity company that provides advanced security solutions to protect against cyber attacks.'),
('Linux', FALSE, '', 'www.linux.org', 'Open-source operating system based on the Unix operating system.'),
('Red Hat', TRUE, '888-467-3342', 'www.redhat.com', 'American software company that provides open-source software products, including the Red Hat Enterprise Linux operating system and cloud computing solutions.');

#update the VENDOR table with the PRODUCT_COUNT values
UPDATE VENDOR SET VENDOR.PRODUCT_COUNT = (
	SELECT COUNT(PRODUCT.PRODUCT_NAME) FROM PRODUCT WHERE VENDOR.VENDOR_NAME = PRODUCT.VENDOR_NAME
);


#create the PATCH table
DROP TABLE IF EXISTS PATCH;
CREATE TABLE PATCH (
	PATCH_ID INT(3) PRIMARY KEY NOT NULL,
    PATCH_TYPE CHAR(60) NOT NULL,
    PATCH_PRIORITY INT(2),
    PATCH_SOURCE CHAR(60),
    PATCH_UPDATE_COMPONENT CHAR(20),
    PATCH_DESCRIPTION CHAR(255)
);

#populate the PATCH table
INSERT INTO PATCH VALUES(1, "General Update", 8, 'Vendor', 'Software', "Apply vendor's updates as recommended.");
INSERT INTO PATCH VALUES(2, 'None', NULL, NULL, NULL, 'No patch is available.');
INSERT INTO PATCH VALUES(3, 'Cumulative Update', 3, 'Vendor', 'Software','A Cumulative Update includes all previous updates and patches, as well as new updates and patches.');
INSERT INTO PATCH VALUES(4, 'Security Update', 1, 'Vendor', 'Software',  'A Security Update specifically addresses security vulnerabilities and is  designed to prevent attacks targeting the vulnerability.');
INSERT INTO PATCH VALUES(5, 'Hotfix', 2, 'Vendor', 'Software', 'A hotfix is a small update that addresses a specific issue, such as a security vulnerability or bug.');
INSERT INTO PATCH VALUES(6, 'Hardware Update', 11, 'Vendor', 'Hardware', 'A Hardware Updates can be used to fix security vulnerabilities in hardware devices.');
INSERT INTO PATCH VALUES(7, 'Third-Party Patch', 7, 'Third-Party', 'Software', 'A Third-Party Patch is a remediation for the vulnerability not given by the vendor issuing the product.');
INSERT INTO PATCH VALUES(8, 'Configuration Change', 5, 'Vendor', 'Software', 'A Configuration Change is a remediation for a vulnerability that is caused by misconfigurations.');
INSERT INTO PATCH VALUES(9, 'Service Pack', 4, 'Vendor', 'Software', 'A service pack is a collection of updates and patches that are released as a single update.');
INSERT INTO PATCH VALUES(10, 'Firmware Update', 10, 'Vendor', 'Software', 'A Firmware Update is used to fix security vulnerabilities in hardware devices, such as routers and printers.');
INSERT INTO PATCH VALUES(11, 'Kernel Update', 6, 'Vendor', 'Hardware', 'A Kernel Update is an updates to the core operating system software that controls the communication between hardware and software.');
INSERT INTO PATCH VALUES(12, 'Load Balancing', 9, 'Internal', 'Hardware', 'Load Balancing is a remediation that distributes traffic across multiple servers to reduce the risk of exploitation on a vulnerable server, application, or service.');


#create the INCIDENT table
DROP TABLE IF EXISTS INCIDENT;
CREATE TABLE INCIDENT (
	INCIDENT_ID INT(3) PRIMARY KEY NOT NULL,
    CVE_ID CHAR(15) NOT NULL,
    PATCH_ID INT(3) NOT NULL,
    PRODUCT_NAME CHAR(40) NOT NULL,
    IMPACT_LEVEL CHAR(10),
    INCIDENT_STATUS CHAR(25)
);

#populate the INCIDENT table
INSERT INTO INCIDENT (INCIDENT_ID, CVE_ID, PATCH_ID, PRODUCT_NAME) 
VALUES(1, 'CVE-2013-1690', 1, 'Firefox'),
(2, 'CVE-2013-1690', 1, 'Thunderbird'),
(3, 'CVE-2015-2426', 4, 'Windows'),
(4, 'CVE-2016-3351', 4, 'Edge'),
(5, 'CVE-2016-3351', 4, 'Internet Explorer'),
(6, 'CVE-2018-0180', 2, 'Cisco IOS'),
(7, 'CVE-2018-6065', 4, 'Chromium V8 Engine'),
(8, 'CVE-2019-1388', 3, 'Windows'),
(9, 'CVE-2019-15752', 1, 'Desktop CE'),
(10, 'CVE-2019-2725', 10, 'WebLogic Server'),
(11, 'CVE-2019-3010', 3, 'Solaris'),
(12, 'CVE-2019-5591', 8, 'FortiOS'),
(13, 'CVE-2019-9978', 7, 'Social-Warfare'),
(14, 'CVE-2020-0041', 4, 'Android OS'),
(15, 'CVE-2020-0601', 5, 'Windows'),
(16, 'CVE-2020-10148', 1, 'Orion Platform'),
(17, 'CVE-2020-17530', 1, 'Struts'),
(18, 'CVE-2020-2021', 8, 'PANOS'),
(19, 'CVE-2020-3161', 10, 'IP Phones'),
(20, 'CVE-2020-3580', 2, 'ASA'),
(21, 'CVE-2020-3580', 2, 'FTD'),
(22, 'CVE-2020-3952', 1, 'vCenterServer'),
(23, 'CVE-2020-4006', 9, 'Workspace One Access'),
(24, 'CVE-2020-4006', 9, 'Access Connector'),
(25, 'CVE-2020-4006', 9, 'Identity Manager'),
(26, 'CVE-2020-4427', 9, 'Data Risk Manager'),
(27, 'CVE-2020-8196', 5, 'ADC'),
(28, 'CVE-2020-9819', 4, 'iOS Mail'),
(29, 'CVE-2021-1498', 1, 'HyperFlex HX'),
(30, 'CVE-2021-1879', 3, 'Apple iOS'),
(31, 'CVE-2021-21017', 1, 'Acrobat'),
(32, 'CVE-2021-21017', 1, 'Reader'),
(33, 'CVE-2021-21148', 3, 'Chromium V8 Engine'),
(34, 'CVE-2021-21224', 9, 'Chromium V8 Engine'),
(35, 'CVE-2021-21973', 4, 'vCenterServer'),
(36, 'CVE-2021-21985', 4, 'vCenterServer'),
(37, 'CVE-2021-30563', 3, 'Chrome'),
(38, 'CVE-2021-30665', 5, 'Safari'),
(39, 'CVE-2021-30983', 4, 'Apple iOS'),
(40, 'CVE-2021-34484', 3, 'Windows'),
(41, 'CVE-2021-37976', 1, 'Chrome'),
(42, 'CVE-2021-38003', 1, 'Chromium V8 Engine'),
(43, 'CVE-2021-38647', 4, 'Azure OMI'),
(44, 'CVE-2021-38649', 4, 'Azure OMI'),
(45, 'CVE-2022-0028', 8, 'PANOS'),
(46, 'CVE-2022-0847', 11, 'Kernel'),
(47, 'CVE-2022-26904', 3, 'Windows'),
(48, 'CVE-2022-27518', 8, 'ADC'),
(49, 'CVE-2022-27518', 8, 'Gateway'),
(50, 'CVE-2022-32917', 4, 'Apple iOS'),
(51, 'CVE-2022-32917', 4, 'macOS'),
(52, 'CVE-2022-40684', 1, 'FortiOS'),
(53, 'CVE-2022-41128', 3, 'Windows'),
(54, 'CVE-2022-41328', 1, 'FortiOS'),
(55, 'CVE-2022-4135', 5, 'Chromium V8 Engine'),
(56, 'CVE-2022-42475', 8, 'FortiOS'),
(57, 'CVE-2022-44698', 4, 'Defender'),
(58, 'CVE-2023-23397', 4, 'Office'),
(59, 'CVE-2023-24880', 5, 'Windows'),
(60, 'CVE-2023-28206', 4, 'Apple iOS'),
(61, 'CVE-2023-28206', 4, 'macOS');

#update the INCIDENT_STATUS column
UPDATE INCIDENT SET INCIDENT.INCIDENT_STATUS = (
	IF(INCIDENT.PATCH_ID = 2, 'Not Resolved', 'Resolved')
);



#create the IMPACT table
DROP TABLE IF EXISTS IMPACT;
CREATE TABLE IMPACT (
	IMPACT_LEVEL CHAR(10) PRIMARY KEY NOT NULL,
    CVSS_MIN DECIMAL(2,1) NOT NULL,
    CVSS_MAX DECIMAL(3,1) NOT NULL,
    IMPACT_DESCRIPTION CHAR(255),
    CVSS_VERSION CHAR(2),
    CVSS_PROVIDER CHAR(3)
);

#populate the IMPACT table
INSERT INTO IMPACT VALUES ('None', 0.0, 0.0, 'The vulnerability does not have any impact on the affected system or data.', 'v3', 'NVD');
INSERT INTO IMPACT VALUES ('Low', .1, 3.9, 'The vulnerability has a limited impact on the affected system or data, and may require some form of user interaction or special conditions to be exploited.', 'v3', 'NVD');
INSERT INTO IMPACT VALUES ('Medium', 4.0, 6.9, 'The vulnerability has a moderate impact on the affected system or data, and may be more easily exploitable than low-severity vulnerabilities.', 'v3', 'NVD');
INSERT INTO IMPACT VALUES ('High', 7.0, 8.9, 'The vulnerability has a significant impact on the affected system or data, and may be highly exploitable.', 'v3', 'NVD');
INSERT INTO IMPACT VALUES ('Critical', 9.0, 10.0, 'The vulnerability has a severe impact on the affected system or data, and may be easily exploitable.', 'v3', 'NVD');


#update the IMPACT_LEVEL column
UPDATE INCIDENT 
JOIN CVE ON INCIDENT.CVE_ID = CVE.CVE_ID
JOIN IMPACT ON CVE.CVSS_SCORE >= IMPACT.CVSS_MIN AND CVE.CVSS_SCORE < IMPACT.CVSS_MAX
SET INCIDENT.IMPACT_LEVEL = IMPACT.IMPACT_LEVEL;
